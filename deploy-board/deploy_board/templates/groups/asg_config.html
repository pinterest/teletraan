{% extends 'environs/env_base.html' %}
{% load static %}
{% load utils %}

{% block breadcrumb-items %}
<ul class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/groups/">Groups</a></li>
    <li><a href="/groups/{{ group_name }}/">{{ group_name }}</a></li>
    <li>Config</li>
</ul>
{% endblock %}

{% block side-panel-actions %}
<link rel="stylesheet" href="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">
<style>
    .ct-series-a .ct-bar {
        stroke: #2a7b86;
    }

    .ct-chart table td {
        text-align: center;
    }
</style>
<script type="text/javascript" src="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>
<script type="text/javascript" src="{% static "js/components/sharedcomponents.js"%}?changedate=2016.12.19.150000"></script>
<script type="text/javascript" src="{% static "js/components/capacitycomponents.js"%}?changedate=2017.07.05.180000"></script>
<script type="text/javascript" src="{% static "js/components/clusterconfigcomponents.js"%}?changedate=2018.05.17.153000"></script>

<div class="panel panel-default" id="side-panel">
    <div class="panel-heading clearfix">
        <h4 class="panel-title pull-left">Capacity</h4>
    </div>
    <div v-if="noCluster" class="row">
        <side-button styleclass="fa fa-cloud" text="Create New Capacity" href="/env/{{ env.envName }}/{{ env.stageName }}/config/newcapacity/" title="Create New Cluster"></side-button>
    </div>
    <div v-if="!noCluster" class="row">
        <side-button-nolink styleclass="fa fa-gears" v-on:click="buttonClick" v-bind:text="settingText" title="Cluster Configuration"></side-button-nolink>
    </div>
    <div v-if="!noCluster" class="row">
        <side-button styleclass="glyphicon glyphicon-time" text="Replacement History" href="/env/{{ env.envName }}/{{ env.stageName }}/replacement" title="Replacement History"></side-button>
    </div>
    <replace-cluster v-bind:clusterstate="clusterState" v-on:input="clusterAction"></replace-cluster>
</div>
<div class="panel panel-default">
{% include "groups/group_side_panel.html" %}
</div>


{% endblock %}

{% block new-builds-panel %}
{% endblock %}
{% block new-pred-deploys-panel %}
{% endblock %}

{% block main %}


{% if asg_vm_config %}
    {% if not is_cmp %}
    <div id="launchConfigPid" class="panel panel-default">
    {% include "groups/launch_config.tmpl" with config=asg_vm_config  %}
    </div>
    {% endif %}

    <div id="groupConfigPid" class="panel panel-default">
    {% include "groups/group_config.tmpl" with config=group_config %}
    </div>

    {% if asg_vm_config.asgStatus != "UNKNOWN" %}
    <script type="text/javascript" src="{% static "js/components/sharedcomponents.js"%}"></script>
    <script type="text/javascript" src="{% static "js/components/capacitycomponents.js"%}"></script>
    <div id="asgConfigPid" class="panel panel-default">
    {% include "groups/asg_config.tmpl" %}
    </div>
    {% endif %}
<script>
$(function() {
    $.get('/groups/{{ group_name }}/autoscaling/get_launch_config/', function(response){
        $('#launchConfigPid').html(response);
    });

    $.get('/groups/{{ group_name }}/autoscaling/get_asg_config/', function(response) {
        $('#asgConfigPid').html(response);
    });
});

</script>
{% else %}
{% include "clusters/cluster_configuration.tmpl" %}
{% endif %}
{% endblock %}
